Проект № 1.

Анализ публикуемых новостей

Общая задача: создать ETL-процесс формирования витрин данных для анализа публикаций новостей.

Подробное описание задачи:

    Разработать скрипты загрузки данных в 2-х режимах:

o   Инициализирующий – загрузка полного слепка данных источника

o   Инкрементальный – загрузка дельты данных за прошедшие сутки

    Организовать правильную структуру хранения данных

o   Сырой слой данных

o   Промежуточный слой

o   Слой витрин

В качестве результата работы программного продукта необходимо написать скрипт, который формирует витрину данных следующего содержания

    Суррогатный ключ категории
    Название категории
    Общее количество новостей из всех источников по данной категории за все время
    Количество новостей данной категории для каждого из источников за все время
    Общее количество новостей из всех источников по данной категории за последние сутки
    Количество новостей данной категории для каждого из источников за последние сутки
    Среднее количество публикаций по данной категории в сутки
    День, в который было сделано максимальное количество публикаций по данной новости
    Количество публикаций новостей данной категории по дням недели

    Суррогатный ключ
    категория
    источник
    время-дата публикации

wget https://jdbc.postgresql.org/download/postgresql-42.5.1.jar
      val spark = SparkSession
          .builder()
          .config(sparkConf)
          .config("spark.jars", "/path_to_postgresDriver/postgresql-42.2.5.jar")
          .getOrCreate()

./sparkjars/postgresql-42.5.1.jar


Дополнение:

Т.к. в разных источниках названия и разнообразие категорий могут отличаться, вам необходимо привести все к единому виду.

Источники:

    https://lenta.ru/rss/
    https://www.vedomosti.ru/rss/news
    https://tass.ru/rss/v2.xml

    docker pull postgres
    docker run --name some-postgres -e POSTGRES_PASSWORD=mysecretpassword -d -p 5432:5432 postgres
    docker exec -it $(docker ps -q) bash
    # psql --user postgres -c 'create database main;'

=====
<guid>https://lenta.ru/news/2022/12/12/makarevich/</guid>
<author>Марина Совина</author>
<title>Cуд объяснил признание Макаревича иноагентом</title>
<link>https://lenta.ru/news/2022/12/12/makarevich/</link>
<description>
Создателя группы «Машина времени» Андрея Макаревича признали иноагентом из-за его высказываний, отождествляющих Россию и нацистскую Германию. Такая причина названа в решении Замоскворецкого суда. Минюст включил Макаревича в реестр физических лиц, выполняющих функции иностранных агентов, 2 сентября.
</description>
<pubDate>Mon, 12 Dec 2022 22:50:45 +0300</pubDate>
<enclosure url="https://icdn.lenta.ru/images/2022/12/12/22/20221212224944192/pic_26b8c34eccc075dfcd3460bc17527f72.jpg" type="image/jpeg" length="16382"/>
<category>Силовые структуры</category>
---
<title> В Турции заявили об обнаружении месторождения нефти на $12 млрд</title>
<link> https://www.vedomosti.ru/economics/news/2022/12/12/954951-v-turtsii-zayavili-ob-obnaruzhenii</link>
<guid> https://www.vedomosti.ru/economics/news/2022/12/12/954951-v-turtsii-zayavili-ob-obnaruzhenii</guid>
<pdalink> https://www.vedomosti.ru/economics/news/2022/12/12/954951-v-turtsii-zayavili-ob-obnaruzhenii</pdalink>
<category>Экономика</category>
<enclosure url="https://cdn.vdmsti.ru/image/2022/9m/1bwyid/normal-1q3j.jpg" type="image/jpeg"/>
<pubDate>Mon, 12 Dec 2022 22:42:08 +0300</pubDate>